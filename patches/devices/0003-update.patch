From: Gavin Lambert <gavinl@compacsort.com>
Date: Thu, 2 Nov 2017 17:14:45 +1300

Make rejects from update scripts easier to interpret.

diff --git a/devices/e1000/update.sh b/devices/e1000/update.sh
--- a/devices/e1000/update.sh
+++ b/devices/e1000/update.sh
@@ -16,7 +16,7 @@ for f in $KERNELDIR/drivers/net/ethernet
     cp -v $o $e
     op=${b/\./-$PREVER-orig.}
     ep=${b/\./-$PREVER-ethercat.}
-    diff -u $op $ep | patch -p1 $e
+    diff -up $op $ep | patch -p1 $e
     sed -i s/$PREVER-ethercat.h/$KERNELVER-ethercat.h/ $e
     hg add $o $e
 done
diff --git a/devices/e1000e/update.sh b/devices/e1000e/update.sh
--- a/devices/e1000e/update.sh
+++ b/devices/e1000e/update.sh
@@ -16,7 +16,7 @@ for f in $KERNELDIR/drivers/net/ethernet
     cp -v $o $e
     op=${b/\./-$PREVER-orig.}
     ep=${b/\./-$PREVER-ethercat.}
-    diff -u $op $ep | patch -p1 $e
+    diff -up $op $ep | patch -p1 $e
     sed -i s/$PREVER-ethercat.h/$KERNELVER-ethercat.h/ $e
     hg add $o $e
 done
diff --git a/devices/igb/update.sh b/devices/igb/update.sh
new file mode 100755
--- /dev/null
+++ b/devices/igb/update.sh
@@ -0,0 +1,22 @@
+#!/bin/bash
+
+set -x
+
+KERNELDIR=/data/kernel/linux-3.16.6
+PREVER=3.14
+KERNELVER=3.16
+
+for f in $KERNELDIR/drivers/net/ethernet/intel/igb/*.[ch]; do
+    echo $f
+    b=$(basename $f)
+    o=${b/\./-$KERNELVER-orig.}
+    e=${b/\./-$KERNELVER-ethercat.}
+    cp -v $f $o
+    chmod 644 $o
+    cp -v $o $e
+    op=${b/\./-$PREVER-orig.}
+    ep=${b/\./-$PREVER-ethercat.}
+    diff -up $op $ep | patch -p1 $e
+    sed -i s/$PREVER-ethercat.h/$KERNELVER-ethercat.h/ $e
+    hg add $o $e
+done
diff --git a/devices/update.sh b/devices/update.sh
--- a/devices/update.sh
+++ b/devices/update.sh
@@ -16,6 +16,6 @@ for f in $KERNELDIR/drivers/net/ethernet
     cp -v $o $e
     op=${b/\./-$PREVER-orig.}
     ep=${b/\./-$PREVER-ethercat.}
-    diff -u $op $ep | patch -p1 $e
+    diff -up $op $ep | patch -p1 $e
     hg add $o $e
 done
